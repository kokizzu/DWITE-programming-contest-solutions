<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>DWITE • October 2009 • Running In Circles</title>
		<link rel="Stylesheet" href="stylish.css" type="text/css">
	</head>
	<body>
		<header>
			<h1>DWITE Online Computer Programming Contest</h1>
			<div>
				<h2>Running In Circles</h2>
				<div>
					<div>October 2009</div>
					<div>Problem 5</div>
				</div>
			</div>
		</header>
		<article>
			<p>Given a directional graph (think of it as a map of one-way streets), cycles (a loop) are often involved in various problems. We know that one (and only one) cycle exists, and we want to find its length.</p>
			<p>The input file <strong>DATA5.txt</strong> will contain 5 sets of input. The first line will contain a single integer, 1 ≤ <var>N</var> ≤ 100, the number of pairs describing the graph. This is followed by <var>N</var> lines, each having two integers separated by a space. Each of the integers refers to a node, and the pair describes a directional path from the first node to the second. Node IDs are between 1 and 100, inclusive. <em>The first node in the list is guaranteed to have a path to the cycle.</em></p>
			<p><em>For example:</em> If the graph is described by 4 pairs: 1 2, 2 3, 3 1, 4 5; then it describes a disjoint graph – a cycle of length 3 and another pair of nodes. Since it’s guaranteed that starting at node 1 will lead to a cycle, it shouldn’t matter that it’s not connected to 4 or 5.</p>
			<p><em>Note:</em> A node could link to itself (1 → 1) and that will form a cycle of size 1.</p>
			<svg style="width:25em" version="1.1" viewBox="-40 -40 11080 4080">
				<g stroke="#000000" stroke-width="80" fill="#FFFFFF">
					<circle cx="700" cy="700" r="700"/>
					<circle cx="3600" cy="1400" r="700"/>
					<circle cx="1800" cy="3300" r="700"/>
					<circle cx="5600" cy="2900" r="700"/>
					<circle cx="7300" cy="1100" r="700"/>
				</g>
				<g stroke="none" fill="#000000">
					<path d="M761,920l-56,0l0,-356c-14,13,-31,26,-53,39c-22,13,-41,22,-58,29l0,-54c31,-15,58,-33,81,-54c23,-21,40,-41,49,-60l37,0l0,456z"/>
					<path d="M3745,1566l0,54l-301,0c-1,-13,1,-26,6,-38c8,-21,20,-41,37,-61c17,-20,41,-42,73,-68c49,-41,83,-74,100,-97c18,-24,27,-46,27,-68c0,-22,-8,-40,-24,-56c-16,-15,-37,-22,-62,-22c-27,0,-49,8,-65,24c-16,16,-24,38,-24,67l-57,-7c3,-42,18,-75,44,-97c25,-22,60,-34,103,-34c44,0,78,13,103,37c26,24,39,54,39,90c0,18,-4,36,-12,53c-7,18,-19,36,-37,56c-17,19,-45,46,-85,80c-34,28,-55,47,-65,57c-10,10,-17,20,-24,30l224,0z"/>
					<path d="M1652,3402l56,-7c6,31,17,53,32,67c15,14,34,21,56,21c27,0,49,-10,67,-28c18,-18,27,-40,27,-67c0,-26,-9,-47,-26,-64c-16,-16,-37,-25,-63,-25c-11,0,-24,2,-39,7l6,-49c3,0,6,0,9,0c24,0,45,-6,64,-19c19,-12,28,-31,28,-57c0,-21,-6,-38,-20,-51c-14,-14,-32,-20,-55,-20c-21,0,-40,6,-54,20c-15,14,-24,34,-29,62l-56,-10c7,-38,23,-67,47,-88c25,-20,55,-30,91,-30c25,0,48,5,69,16c21,10,37,25,48,43c11,19,17,38,17,59c0,20,-6,38,-16,54c-11,16,-26,29,-47,38c27,7,48,20,62,39c15,20,23,44,23,73c0,40,-15,74,-44,101c-29,28,-65,41,-109,42c-40,-1,-73,-12,-99,-36c-27,-23,-42,-54,-45,-91z"/>
					<path d="M5629,3121c0,-37,0,-73,0,-109c-66,0,-131,0,-197,0c0,-17,0,-34,0,-51c69,-99,138,-197,207,-295c16,0,31,0,47,0c0,98,0,196,0,295c20,0,40,0,61,0c0,17,0,34,0,51c-21,0,-41,0,-61,0c0,36,0,72,0,109c-19,0,-38,0,-57,0zm0,-160c0,-69,0,-137,0,-205c-47,68,-95,136,-143,205c48,0,96,0,143,0z"/>
					<path d="M7151,1202l57,-4c4,28,14,49,30,63c16,14,35,22,58,22c28,0,51,-11,70,-31c18,-20,28,-47,28,-81c0,-32,-9,-57,-27,-76c-18,-18,-42,-27,-71,-27c-19,0,-35,4,-49,12c-15,8,-26,19,-34,33l-52,-7l44,-235l227,0l0,54l-183,0l-24,122c27,-19,56,-28,86,-28c40,0,73,13,100,41c28,27,42,63,42,106c0,41,-13,77,-37,107c-29,37,-69,55,-119,56c-42,-1,-75,-12,-102,-35c-26,-23,-41,-54,-44,-92z"/>
				</g>
				<g stroke="#000000" stroke-width="120" fill="none">
					<line x1="1421" y1="856" x2="2320" y2="1083"/>
					<line x1="1517" y1="2612" x2="1226" y2="1909"/>
					<line x1="3099" y1="1944" x2="2718" y2="2346"/>
					<line x1="6106" y1="2363" x2="6389" y2="2060"/>
				</g>
				<g stroke="none" fill="#000000">
					<path d="M2876,1223l-533,-341l-98,388l631,-47z"/>
					<path d="M1006,1379l45,631l369,-153l-414,-478z"/>
					<path d="M2323,2762l558,-298l-290,-275l-268,573z"/>
					<path d="M6780,1641l-556,302l293,273l263,-575z"/>
					<path d="M8857,637l32,-3c1,13,5,23,10,31c6,8,14,15,25,20c12,5,25,7,39,7c13,0,24,-2,33,-6c10,-3,17,-9,22,-15c5,-7,7,-14,7,-22c0,-8,-2,-15,-7,-20c-5,-6,-13,-11,-23,-15c-7,-3,-22,-7,-45,-13c-23,-5,-39,-10,-48,-15c-12,-7,-21,-14,-27,-24c-6,-9,-9,-20,-9,-31c0,-13,4,-25,11,-36c7,-11,18,-20,31,-25c14,-6,30,-9,47,-9c18,0,35,3,49,9c14,6,25,15,33,27c7,12,11,25,12,40l-32,2c-2,-16,-8,-28,-17,-36c-10,-8,-25,-12,-44,-12c-20,0,-35,4,-44,11c-9,7,-14,16,-14,27c0,9,3,16,10,22c6,6,23,12,50,18c27,6,46,11,56,16c14,7,25,15,32,26c7,10,11,22,11,36c0,13,-4,26,-11,37c-8,12,-19,22,-33,28c-15,7,-31,10,-49,10c-23,0,-42,-3,-57,-10c-15,-7,-27,-17,-36,-30c-9,-13,-14,-28,-14,-45z"/>
					<path d="M9218,695c-11,10,-22,17,-33,21c-11,4,-22,6,-35,6c-20,0,-36,-5,-47,-15c-11,-10,-16,-22,-16,-38c0,-9,2,-17,6,-24c4,-8,10,-14,16,-18c7,-5,15,-8,23,-11c6,-1,15,-3,28,-4c25,-3,44,-7,56,-11c0,-4,0,-7,0,-8c0,-13,-3,-21,-9,-27c-8,-7,-20,-10,-36,-10c-15,0,-26,2,-33,7c-7,5,-13,14,-16,27l-31,-4c3,-13,7,-23,14,-31c6,-8,16,-14,28,-19c12,-4,26,-6,42,-6c16,0,29,2,39,5c10,4,17,9,22,14c4,6,8,13,9,21c1,6,2,15,2,29l0,42c0,29,1,47,2,55c1,8,3,15,7,22l-31,0c-4,-7,-6,-14,-7,-23zm-2,-70c-11,5,-29,9,-52,12c-13,2,-22,4,-27,6c-6,3,-10,6,-13,11c-3,4,-4,9,-4,15c0,8,3,15,10,21c6,5,15,8,27,8c13,0,23,-3,33,-8c9,-5,16,-13,21,-22c3,-7,5,-17,5,-31l0,-12z"/>
					<path d="M9292,718l0,-184l28,0l0,26c6,-9,14,-16,23,-22c10,-5,21,-8,33,-8c13,0,24,3,33,8c9,6,15,14,18,24c15,-21,34,-32,57,-32c19,0,33,5,43,15c9,10,14,26,14,47l0,126l-31,0l0,-116c0,-12,-1,-21,-3,-27c-2,-5,-5,-10,-11,-13c-5,-3,-11,-5,-19,-5c-13,0,-23,4,-32,13c-8,8,-13,22,-13,41l0,107l-31,0l0,-119c0,-14,-2,-25,-7,-32c-5,-7,-14,-10,-25,-10c-9,0,-17,2,-25,7c-7,5,-12,11,-16,20c-3,9,-5,22,-5,39l0,95l-31,0z"/>
					<path d="M9584,788l0,-254l28,0l0,24c7,-10,14,-16,23,-21c8,-5,18,-7,30,-7c16,0,30,4,42,12c12,8,21,20,27,34c6,15,9,31,9,49c0,18,-3,35,-10,50c-7,15,-17,27,-29,35c-13,8,-27,12,-41,12c-10,0,-20,-2,-28,-7c-8,-4,-15,-10,-20,-17l0,90l-31,0zm27,-161c0,23,5,41,15,52c9,11,21,17,35,17c14,0,26,-6,36,-18c10,-11,15,-29,15,-54c0,-23,-5,-41,-15,-53c-9,-11,-21,-17,-35,-17c-13,0,-25,6,-35,19c-11,12,-16,30,-16,54z"/>
					<path d="M9778,718c0,-84,0,-169,0,-253c10,0,21,0,31,0c0,84,0,169,0,253c-10,0,-21,0,-31,0z"/>
					<path d="M9980,659l32,4c-5,19,-14,33,-28,44c-14,10,-31,15,-53,15c-26,0,-48,-8,-63,-25c-16,-16,-24,-40,-24,-69c0,-31,8,-55,24,-72c16,-17,36,-26,62,-26c24,0,44,8,60,25c15,17,23,40,23,71c0,2,0,4,0,8l-138,0c1,20,7,35,17,46c11,11,23,16,39,16c11,0,21,-3,29,-9c8,-6,15,-15,20,-28zm-104,-51l104,0c-1,-15,-5,-27,-12,-34c-10,-12,-23,-18,-39,-18c-15,0,-27,5,-37,14c-9,10,-15,22,-16,38z"/>
					<path d="M10156,718c0,-84,0,-169,0,-253c11,0,22,0,33,0c0,84,0,169,0,253c-11,0,-22,0,-33,0z"/>
					<path d="M10245,718l0,-184l28,0l0,26c13,-20,33,-30,58,-30c11,0,21,2,30,6c9,4,16,9,21,16c4,6,7,14,9,23c1,5,2,16,2,30l0,113l-31,0l0,-112c0,-13,-1,-22,-4,-28c-2,-7,-6,-12,-12,-15c-6,-4,-14,-6,-22,-6c-13,0,-24,4,-34,13c-9,8,-14,24,-14,48l0,100l-31,0z"/>
					<path d="M10439,788l0,-254l28,0l0,24c7,-10,14,-16,23,-21c8,-5,18,-7,30,-7c16,0,30,4,42,12c12,8,21,20,27,34c6,15,9,31,9,49c0,18,-3,35,-10,50c-7,15,-17,27,-29,35c-13,8,-27,12,-41,12c-10,0,-20,-2,-28,-7c-8,-4,-15,-10,-20,-17l0,90l-31,0zm27,-161c0,23,5,41,15,52c9,11,21,17,35,17c14,0,26,-6,36,-18c10,-11,15,-29,15,-54c0,-23,-5,-41,-15,-53c-9,-11,-21,-17,-35,-17c-13,0,-25,6,-35,19c-11,12,-16,30,-16,54z"/>
					<path d="M10755,718l0,-27c-14,21,-34,31,-58,31c-11,0,-21,-2,-31,-6c-9,-4,-16,-10,-20,-16c-5,-6,-8,-14,-10,-23c-1,-6,-2,-16,-2,-29l0,-114l31,0l0,102c0,16,1,27,2,33c2,8,6,14,12,19c7,5,15,7,24,7c9,0,18,-2,26,-7c9,-5,14,-11,18,-20c3,-8,5,-20,5,-36l0,-98l31,0l0,184l-28,0z"/>
					<path d="M10897,690l4,27c-9,2,-17,3,-24,3c-11,0,-20,-2,-26,-5c-6,-4,-11,-9,-13,-14c-3,-6,-4,-19,-4,-37l0,-106l-23,0l0,-24l23,0l0,-45l31,-19l0,64l32,0l0,24l-32,0l0,107c0,9,1,14,2,17c1,2,3,4,5,6c3,1,6,2,11,2c4,0,8,0,14,0z"/>
					<path d="M10934,568c0,-11,0,-23,0,-34c11,0,23,0,34,0c0,11,0,23,0,34c-11,0,-23,0,-34,0zm0,150c0,-11,0,-23,0,-34c11,0,23,0,34,0c0,11,0,23,0,34c-11,0,-23,0,-34,0z"/>
					<path d="M10908,1215l0,-117l-65,117l65,0zm-19,79c-5,0,-9,-1,-11,-3c-2,-1,-3,-5,-3,-9c0,-4,1,-7,3,-9c2,-2,5,-3,10,-3l20,0l0,-29l-80,0c-3,0,-5,-1,-7,-3c-1,-2,-2,-4,-2,-8l0,-11c0,-5,2,-10,5,-15c1,-1,1,-2,1,-2l72,-124c2,-2,3,-4,4,-5c2,-1,3,-1,5,-1c1,0,2,0,3,0c0,0,1,0,2,0l18,3c1,0,3,1,4,3c1,1,1,3,1,6l0,131l9,0c2,0,4,-1,6,-3c1,-2,3,-3,5,-3c2,0,4,1,6,2c1,2,2,4,2,7c0,1,0,2,0,3c0,1,-1,1,-1,2l-2,8c-1,4,-2,6,-3,8c-2,1,-4,2,-8,2l-14,0l0,29l6,0c7,0,12,1,15,3c3,1,4,4,4,9c0,4,-1,7,-3,9c-3,2,-6,3,-11,3l-56,0z"/>
					<path d="M10430,1516c-2,1,-3,1,-4,1c0,0,-1,0,-2,0c-3,0,-6,-1,-8,-3c-2,-2,-4,-5,-4,-8c0,-3,1,-5,3,-7c2,-2,5,-4,9,-5l51,-14c1,0,2,-1,3,-1c2,0,3,0,4,0c2,0,4,1,5,3c1,2,2,5,2,8l0,187l27,0c11,0,17,1,20,2c3,2,4,5,4,10c0,4,-1,7,-3,9c-3,2,-6,3,-11,3l-102,0c-5,0,-8,-1,-11,-3c-2,-2,-3,-5,-3,-9c0,-5,1,-8,4,-10c3,-1,9,-2,20,-2l28,0l0,-168l-32,7z"/>
					<path d="M10834,1701c-6,0,-11,-1,-14,-4c-3,-2,-4,-6,-4,-11c0,-7,10,-21,31,-40c3,-3,5,-5,7,-7c3,-3,7,-7,13,-12c41,-38,61,-66,61,-84c0,-12,-3,-22,-10,-30c-7,-7,-16,-11,-28,-11c-7,0,-14,1,-21,4c-6,3,-11,7,-15,12c-1,1,-2,3,-3,5c-4,7,-10,11,-16,11c-4,0,-6,-1,-8,-4c-1,-2,-2,-7,-2,-14c0,-4,0,-7,1,-9c1,-2,2,-4,5,-6c7,-7,16,-13,27,-17c11,-4,22,-6,33,-6c19,0,35,6,48,18c13,12,19,28,19,46c0,22,-20,52,-59,90c-9,9,-17,16,-22,22l-21,20l78,0c0,-5,2,-9,4,-11c2,-3,5,-4,9,-4c4,0,7,1,9,4c2,2,3,6,3,10c0,0,0,1,0,2c0,1,0,1,0,2l-2,13c0,3,-1,6,-3,8c-2,2,-4,3,-7,3l-113,0z"/>
					<path d="M10411,2108c-6,0,-11,-1,-14,-4c-3,-2,-4,-6,-4,-11c0,-7,10,-21,31,-40c3,-3,5,-5,7,-7c3,-3,7,-7,13,-12c41,-38,61,-66,61,-84c0,-12,-3,-22,-10,-30c-7,-7,-16,-11,-28,-11c-7,0,-14,1,-21,4c-6,3,-11,7,-15,12c-1,1,-2,3,-3,5c-4,7,-10,11,-16,11c-4,0,-6,-1,-8,-4c-1,-2,-2,-7,-2,-14c0,-4,0,-7,1,-9c1,-2,2,-4,5,-6c7,-7,16,-13,27,-17c11,-4,22,-6,33,-6c19,0,35,6,48,18c13,12,19,28,19,46c0,22,-20,52,-59,90c-9,9,-17,16,-22,22l-21,20l78,0c0,-5,2,-9,4,-11c2,-3,5,-4,9,-4c4,0,7,1,9,4c2,2,3,6,3,10c0,0,0,1,0,2c0,1,0,1,0,2l-2,13c0,3,-1,6,-3,8c-2,2,-4,3,-7,3l-113,0z"/>
					<path d="M10922,1990c13,4,23,10,31,20c7,10,11,22,11,36c0,20,-7,36,-21,49c-15,13,-33,19,-56,19c-17,0,-33,-3,-47,-10c-13,-7,-20,-14,-20,-22c0,-4,1,-7,4,-9c2,-2,5,-3,9,-3c2,0,9,2,21,8c12,6,24,9,35,9c13,0,24,-4,33,-12c9,-7,13,-17,13,-30c0,-10,-3,-19,-9,-26c-6,-7,-14,-11,-24,-13c-3,-1,-8,-1,-13,-1c-9,-1,-14,-5,-14,-12c0,-7,5,-11,14,-12c4,0,7,-1,9,-1c9,-2,16,-5,22,-11c5,-6,8,-14,8,-22c0,-11,-3,-20,-10,-27c-7,-7,-15,-11,-26,-11c-9,0,-19,3,-30,9c-10,6,-16,9,-19,9c-3,0,-6,-1,-8,-3c-2,-2,-3,-4,-3,-7c0,-7,6,-14,19,-21c13,-7,28,-11,43,-11c18,0,33,5,45,16c12,11,18,25,18,41c0,12,-3,22,-9,30c-6,8,-14,14,-26,18z"/>
					<path d="M10499,2397c13,4,23,10,31,20c7,10,11,22,11,36c0,20,-7,36,-21,49c-15,13,-33,19,-56,19c-17,0,-33,-3,-47,-10c-13,-7,-20,-14,-20,-22c0,-4,1,-7,4,-9c2,-2,5,-3,9,-3c2,0,9,2,21,8c12,6,24,9,35,9c13,0,24,-4,33,-12c9,-7,13,-17,13,-30c0,-10,-3,-19,-9,-26c-6,-7,-14,-11,-24,-13c-3,-1,-8,-1,-13,-1c-9,-1,-14,-5,-14,-12c0,-7,5,-11,14,-12c4,0,7,-1,9,-1c9,-2,16,-5,22,-11c5,-6,8,-14,8,-22c0,-11,-3,-20,-10,-27c-7,-7,-15,-11,-26,-11c-9,0,-19,3,-30,9c-10,6,-16,9,-19,9c-3,0,-6,-1,-8,-3c-2,-2,-3,-4,-3,-7c0,-7,6,-14,19,-21c13,-7,28,-11,43,-11c18,0,33,5,45,16c12,11,18,25,18,41c0,12,-3,22,-9,30c-6,8,-14,14,-26,18z"/>
					<path d="M10853,2330c-2,1,-3,1,-4,1c0,0,-1,0,-2,0c-3,0,-6,-1,-8,-3c-2,-2,-4,-5,-4,-8c0,-3,1,-5,3,-7c2,-2,5,-4,9,-5l51,-14c1,0,2,-1,3,-1c2,0,3,0,4,0c2,0,4,1,5,3c1,2,2,5,2,8l0,187l27,0c11,0,17,1,20,2c3,2,4,5,4,10c0,4,-1,7,-3,9c-3,2,-6,3,-11,3l-102,0c-5,0,-8,-1,-11,-3c-2,-2,-3,-5,-3,-9c0,-5,1,-8,4,-10c3,-1,9,-2,20,-2l28,0l0,-168l-32,7z"/>
					<path d="M10485,2843l0,-117l-65,117l65,0zm-19,79c-5,0,-9,-1,-11,-3c-2,-1,-3,-5,-3,-9c0,-4,1,-7,3,-9c2,-2,5,-3,10,-3l20,0l0,-29l-80,0c-3,0,-5,-1,-7,-3c-1,-2,-2,-4,-2,-8l0,-11c0,-5,2,-10,5,-15c1,-1,1,-2,1,-2l72,-124c2,-2,3,-4,4,-5c2,-1,3,-1,5,-1c1,0,2,0,3,0c0,0,1,0,2,0l18,3c1,0,3,1,4,3c1,1,1,3,1,6l0,131l9,0c2,0,4,-1,6,-3c1,-2,3,-3,5,-3c2,0,4,1,6,2c1,2,2,4,2,7c0,1,0,2,0,3c0,1,-1,1,-1,2l-2,8c-1,4,-2,6,-3,8c-2,1,-4,2,-8,2l-14,0l0,29l6,0c7,0,12,1,15,3c3,1,4,4,4,9c0,4,-1,7,-3,9c-3,2,-6,3,-11,3l-56,0z"/>
					<path d="M10855,2787c7,-3,15,-5,21,-6c7,-1,13,-2,19,-2c20,0,37,7,50,21c13,14,20,31,20,52c0,22,-7,40,-22,54c-15,15,-34,22,-57,22c-19,0,-36,-3,-49,-8c-13,-5,-19,-11,-19,-19c0,-3,1,-6,3,-8c3,-2,5,-3,9,-3c1,0,8,2,20,6c12,5,24,7,34,7c16,0,28,-5,38,-14c9,-9,14,-21,14,-36c0,-14,-5,-26,-14,-36c-9,-9,-20,-14,-34,-14c-10,0,-21,3,-30,8c-10,5,-16,8,-18,8c-4,0,-6,-2,-8,-4c-1,-2,-2,-7,-2,-14l0,-86c0,-4,1,-7,4,-8c2,-2,6,-3,12,-3l87,0c6,0,10,1,13,3c3,3,4,6,4,10c0,5,-1,8,-4,10c-3,3,-7,4,-13,4l-78,0l0,56z"/>
				</g>
			</svg>
			<p>The output file <strong>OUT5.txt</strong> will contain 5 lines of output, each an integer size of the cycle found in a graph.</p>
			<div id="sample_data">
				<div class="sample_in">
					Sample Input:
					<pre>1
1 1
2
1 2
2 1
3
1 2
2 3
3 1
4
1 2
2 3
3 1
4 5
5
1 4
1 2
2 3
3 1
4 5</pre>
				</div>
				<div class="sample_out">
					Sample Output:
					<pre>1
2
3
3
3</pre>
				</div>
			</div>
		</article>
	</body>
</html>
